% Aufgabe 5.8 berechnen Sie die LU-Zerlegungen der Matrizen

A = [1, 2,3, 0; 4, 0, 0, 1; 5, 0, 6, 0; 0, 1, 0, 0];

G_1 = [eye(4)+(-4)*[0;1;0;0]*[1;0;0;0]'];
G_2 = [eye(4)+(-5)*[0;0;1;0]*[1;0;0;0]'];
M_1 = [1, 0, 0, 0; 0, -1/8, 0, 0; 0, 0, 1, 0; 0, 0, 0, 1];
G_3 = [eye(4)+(10)*[0;0;1;0]*[0;1;0;0]'];
G_4 = [eye(4)+(-1)*[0;0;0;1]*[0;1;0;0]'];
M_2 = [1, 0, 0, 0; 0, 1, 0, 0; 0, 0, 1/6, 0; 0, 0, 0, 1];
G_5 = [eye(4)+(1.5)*[0;0;0;1]*[0;0;1;0]'];

A_1 = G_5*M_2*G_4*G_3*M_1*G_2*G_1*A;

Ut = A_1;
Pt = eye(4);
Lt = G_5*M_2*G_4*G_3*M_1*G_2*G_1;
D = diag(diag(Lt));

L = inv(Lt)*D;
P = inv(Pt);
U = inv(D)*Ut;

B  = [2, 0, -2, 0; -4, 0, 4, -1; 0, -1, -1, -2; 0, 0, 1, 1];
P1 = [1, 0, 0, 0; 0, 0, 0, 1; 0, 0, 1, 0; 0, 1, 0, 0];
P2 = [1, 0, 0, 0; 0, 0, 1, 0; 0, 1, 0, 0; 0, 0, 0, 1];

G1 = [eye(4) + (2)*[0; 0; 0; 1]*[1; 0; 0;0]'];

Ut = G1*P2*P1*B;
Lt = G1;
Pt = P2*P1;
D  = diag(diag(Lt));

P  = inv(Pt);
U  = inv(D)*Ut;
L  = inv(Lt)*D;
